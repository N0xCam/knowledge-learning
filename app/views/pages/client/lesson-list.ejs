<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Liste des le√ßons</title>
</head>
<body>
  <!-- ‚úÖ Navbar -->
  <nav>
    <ul>
      <li><a href="/">Accueil</a></li>

      <% if (!session.user) { %>
        <li><a href="/auth/register">S'inscrire</a></li>
        <li><a href="/auth/login">Se connecter</a></li>
      <% } else { %>
        <li><a href="/client/themes">Th√®mes</a></li>
        <li><a href="/client/certifications">Mes certifications</a></li>

        <% if (session.user.role === 'admin') { %>
          <li><a href="/admin/dashboard">Dashboard</a></li>
        <% } %>

        <li>
          <form method="POST" action="/auth/logout" style="display:inline;">
            <button>D√©connexion</button>
          </form>
        </li>
      <% } %>
    </ul>
  </nav>
  <h1>Le√ßons du cursus : <%= cursus.title %></h1>

  <% if (success_msg) { %>
    <p style="color: green;"><%= success_msg %></p>
  <% } %>

  <% if (error_msg) { %>
    <p style="color: red;"><%= error_msg %></p>
  <% } %>

  <ul>
    <% lessons.forEach(lesson => { %>
      <li>
        <strong><%= lesson.title %></strong> ‚Äî <%= lesson.price %> ‚Ç¨
        
        <% if (lessonAccess && lessonAccess[lesson._id]) { %>
          <a href="/client/lessons/<%= lesson._id %>">üìñ Acc√©der √† la le√ßon</a>
        <% } else { %>
          <form action="/purchase/lessons/<%= lesson._id %>" method="POST" style="display:inline;">
            <input type="hidden" name="_csrf" value="<%= csrfToken %>">
            <button type="submit">üí≥ Acheter la le√ßon</button>
          </form>
        <% } %>
      </li>
    <% }) %>
  </ul>

  <p><a href="javascript:history.back()">‚Üê Retour</a></p>
</body>
</html>
