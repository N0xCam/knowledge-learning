<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>DÃ©tails des cursus</title>
  <link rel="stylesheet" href="/css/client.css">
</head>
<body>

<!-- Navbar -->
  <nav>
    <ul>
      <li><a href="/">Accueil</a></li>

      <% if (!session.user) { %>
        <li><a href="/auth/register">S'inscrire</a></li>
        <li><a href="/auth/login">Se connecter</a></li>
      <% } else { %>
        <li><a href="/client/themes">ThÃ¨mes</a></li>
        <li><a href="/client/certifications">Mes certifications</a></li>

        <% if (session.user.role === 'admin') { %>
          <li><a href="/admin/dashboard">Dashboard</a></li>
        <% } %>

      <% } %>
    </ul>
  </nav>
  
 <!-- Cursus title --> 
<h1><%= cursus.title %></h1>
<p>ThÃ¨me : <%= cursus.theme.title %></p>
<p>Prix du cursus complet : <%= cursus.price %> â‚¬</p>

<% if (!hasPurchasedCursus) { %>
  <form action="/purchase/cursus/<%= cursus._id %>" method="POST">
    <input type="hidden" name="_csrf" value="<%= csrfToken %>">
    <button type="submit">Acheter le cursus ğŸ’³</button>
  </form>
<% } else { %>
  <p>âœ… Cursus achetÃ©</p>
<% } %>
<hr>

<!-- Lessons --> 
<h2>LeÃ§ons :</h2>
<ul>
  <% lessons.forEach(lesson => { %>
    <li>
      <%= lesson.title %> â€” <%= lesson.price %> â‚¬
      <% if (validatedLessonIds.includes(lesson._id.toString())) { %>
        âœ…
      <% } %>
      <% if (lessonAccess[lesson._id]) { %>
        â€” <a href="/client/lessons/<%= lesson._id %>">Voir la leÃ§on</a>
      <% } else { %>
        <form action="/purchase/lessons/<%= lesson._id %>" method="POST" style="display:inline;">
          <input type="hidden" name="_csrf" value="<%= csrfToken %>">
          <button type="submit">Acheter</button>
        </form>
      <% } %>
    </li>
  <% }) %>
</ul>



<a href="/client/themes">â† Retour aux thÃ¨mes</a>

</body>
</html>